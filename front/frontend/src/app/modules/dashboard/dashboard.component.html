<div class="dashboard-container">
  <main class="content">

    <!-- ===================== -->
    <!-- CALENDÃRIO -->
    <!-- ===================== -->
    <section class="calendar-section card">
      <div class="calendar-header">
        <button (click)="prevMonth()">&#9664;</button>
        <h2>{{ monthName }} {{ currentYear }}</h2>
        <button (click)="nextMonth()">&#9654;</button>
      </div>

      <table class="calendar">
        <thead>
          <tr>
            <th>Dom</th>
            <th>Seg</th>
            <th>Ter</th>
            <th>Qua</th>
            <th>Qui</th>
            <th>Sex</th>
            <th>SÃ¡b</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let week of weeks">
            <td *ngFor="let day of week" [class.today]="isToday(day)">
              <span *ngIf="day !== 0">{{ day }}</span>
            </td>
          </tr>
        </tbody>
      </table>
    </section>

    <!-- ===================== -->
    <!-- ALUNOS PRINCIPAIS -->
    <!-- ===================== -->
    <section class="students-section card">
      <div class="section-header">
        <h2>Lista de alunos</h2>
        <a href="#" (click)="abrirPopupAlunos($event)">Ver tudo</a>
      </div>

      <ul class="students-list">
        <li *ngFor="let aluno of alunosDetalhados">
          <span class="icon">ðŸ‘¤</span>
          <span>{{ aluno.nome }}</span>
          <button class="edit-btn" (click)="abrirPopupAluno(aluno)">Editar</button>
        </li>
      </ul>
    </section>

    <!-- ===================== -->
    <!-- POPUP LISTA COMPLETA -->
    <!-- ===================== -->
    <div class="popup-overlay" *ngIf="mostrarPopupAlunos">
      <div class="popup-content">
        <button class="close-btn" (click)="fecharPopupAlunos()">Ã—</button>
        <h2>Lista de alunos</h2>

        <table class="popup-table">
          <thead>
            <tr>
              <th>Nome</th>
              <th>Peso</th>
              <th>Altura</th>
              <th>Nascimento</th>
              <th></th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let aluno of alunosDetalhados">
              <td>
                <span class="icon">ðŸ‘¤</span>
                {{ aluno.nome }}
              </td>
              <td>{{ aluno.peso }}</td>
              <td>{{ aluno.altura }}</td>
              <td>{{ aluno.nascimento }}</td>
              <td>
                <button class="editar-btn" (click)="abrirPopupAluno(aluno)">Editar</button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- ===================== -->
    <!-- POPUP EDITAR ALUNO -->
    <!-- ===================== -->
    <div class="popup-overlay" *ngIf="mostrarPopupAluno">
      <div class="edit-student-popup">
        <button class="close-btn" (click)="fecharPopupAluno()">Ã—</button>

        <img [src]="alunoSelecionadoDetalhado?.foto || 'assets/default-avatar.png'" 
             alt="Foto do aluno" class="aluno-foto" />

        <h3>{{ alunoSelecionadoDetalhado?.nome }}</h3>

        <div class="info-grid">
          <div class="label">Nome completo</div>
          <div class="value">{{ alunoSelecionadoDetalhado?.nome }}</div>

          <div class="label">Peso</div>
          <div class="value">{{ alunoSelecionadoDetalhado?.peso }}</div>

          <div class="label">Altura</div>
          <div class="value">{{ alunoSelecionadoDetalhado?.altura }}</div>

          <div class="label">Data de nascimento</div>
          <div class="value">{{ alunoSelecionadoDetalhado?.nascimento }}</div>

          <div class="label">Idade</div>
          <div class="value">{{ alunoSelecionadoDetalhado?.idade }}</div>

          <div class="label">Objetivo</div>
          <div class="value">{{ alunoSelecionadoDetalhado?.objetivo }}</div>
        </div>

        <div class="popup-actions">
          <button class="btn-treino" (click)="abrirTreinoAluno(alunoSelecionadoDetalhado.id)">
            Treino
          </button>
          <button class="btn-salvar" (click)="salvarAluno()">Salvar</button>
        </div>
      </div>
    </div>

    <!-- ===================== -->
    <!-- AULAS (CARREGA DO TS) -->
    <!-- ===================== -->
    <section class="classes-section card">
      <div class="section-header">
        <h2>Aulas</h2>
        <a href="#" (click)="abrirPopup($event)">Ver tudo</a>
      </div>

      <div class="classes-grid">
        <div class="class-card" *ngFor="let aula of aulas" (click)="abrirPopupEditar(aula)">
          <img [src]="aula.img" [alt]="aula.nome" />
          <span>{{ aula.nome }}</span>
        </div>
      </div>
    </section>

    <!-- ===================== -->
    <!-- POPUP EDITAR AULA -->
    <!-- ===================== -->
    <div class="popup-overlay" *ngIf="mostrarPopupEditarAula">
      <div class="edit-class-popup">
        <button class="close-btn" (click)="fecharPopupEditar()">Ã—</button>

        <img [src]="aulaSelecionada?.img" alt="Imagem da Aula">

        <h3>{{ aulaSelecionada?.nome }}</h3>

        <div class="info">
          <label>Professor:</label>
          <p>{{ aulaSelecionada?.professor || 'NÃ£o informado' }}</p>

          <label>HorÃ¡rio:</label>
          <p>{{ aulaSelecionada?.horario || 'NÃ£o informado' }}</p>

          <label>DescriÃ§Ã£o:</label>
          <p>{{ aulaSelecionada?.descricao || 'Sem descriÃ§Ã£o' }}</p>
        </div>

        <div class="botoes">
          <button class="alunos-btn">Alunos</button>
          <button class="salvar-btn">Salvar</button>
        </div>
      </div>
    </div>

  </main>
</div>
